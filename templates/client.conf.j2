###############################
## Auto-generated by:        ##
##         Ansible           ##
## Don't do changes by hand  ##
## Role: matiferrigno.bacula ##
###############################

Client {
  Name = {{ item.name }}-fd
  Address = {{ item.fqdn }}
  FDPort = {{ item.fdport | default(bacula__default__client_fdport) }}
  Catalog = {{ bacula_catalog_name }}
  Password = "{{ item.pass | default(bacula__default__client_pass) }}"
  File Retention = {{ item.file_retention | default(bacula__default__client_file_retention) }}
  Job Retention = {{ item.job_retention | default(bacula_client_job_retention) }}
  AutoPrune = {{ item.auto_prune | default(bacula__default__client_auto_prune) }}
  Maximum Concurrent Jobs = {{ item.maximum_concurrent_jobs | default(bacula__default__client_maximum_concurrent_jobs) }}

  #########
  ## TLS ##
  #########
{% if item.tls_enabled|d() and item.tls_enabled|bool %}
  TLS Enable = {{ item.tls_enabled }}
  TLS Require = {{ item.tls_require | default(bacula_client_tls_require) }}
  TLS CA Certificate File = {{ item.tls_ca_certificate | default(bacula__default__ca_certificate) }}
{% else %}
  TLS Enable = no
{% endif %}
}

{% if item.policies|d() %}
{% for policy in item.policies %}
{% if policy.enabled %}
@/etc/bacula/policies.d/{{ item.name }}-{{ policy.name }}.conf
{% endif %}
{% endfor %}
{% endif %}
